<!--
 * @Description: In User Settings Edit
 * @Author: JYK
 * @Date: 2019-08-06 20:41:48
 * @LastEditTime: 2019-08-12 20:32:47
 * @LastEditors: Please set LastEditors
 -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Charisma, a fully featured, responsive, HTML5, Bootstrap admin template.">
    <meta name="author" content="Muhammad Usman">
    <title>后台管理系统</title>
    <link href="/static/admin/lib/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/static/admin/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/admin/lib/bootstrap-tour/build/css/bootstrap-tour.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/admin/css/iconfont.css">
    <link rel="stylesheet" href="/static/admin/css/diaryAdd.css">
    <link rel="stylesheet" href="/static/lib/editor/css/editormd.min.css">
    <link rel="stylesheet" href="/static/admin/css/nav.css">

    <link rel="shortcut icon" href="/static/admin/images/icon.png" type="image/x-icon">
</head>
<body>
<!-- 导航条开始-->
{include file="common:header"}
<!-- 导航条结束 -->
<div class="ch-container">
    <div class="row">
        <!-- 左侧导航栏开始-->
        {include file="common:left"}
        <!-- 左侧导航栏结束 -->

        <!--面包屑导航栏开始-->
        <ul class="breadcrumb">
             
            <li><a href="{:url('admin/index/index')}">首页</a></li>
            <li><a href="{:url('admin/index/diarymessage')}">日迹管理</a></li>
             
            <li class="active">发布日迹</li>
        </ul>
        <!--面包屑导航栏结束-->

        <!--发布详情开始-->
        <div class="col-sm-8 wm-release-div">
                <form action="{:url('admin/User/diaryadd')}" method="post" class="form-inline wm-person" enctype="multipart/form-data">
                    <ol>
                        <!--<li class="wm-div2-li1">-->
                            <!--<div class="form-group">-->
                                <!--<div class="btn btn-primary btn-file">-->
                                    <!--选择日迹插图-->
                                    <!--<input type="file" name="diary_img[]" class="input-file form-control" id="diary-img" multiple="multiple" title="">-->
                                <!--</div>-->
                                    <!--<div id="show-img"></div>-->
                            <!--</div>-->
                        <!--</li>-->
                        <li class="wm-div2-li3">
                            <div class="editormd" id="diary-editormd">
                                <textarea class="editormd-markdown-textarea" name="diary_content"></textarea>
                                <!-- 第二个隐藏文本域，用来构造生成的HTML代码，方便表单POST提交，这里的name可以任意取，后台接受时以这个name键为准 -->
                                <textarea class="editormd-html-textarea" name="diary_content"></textarea>
                            </div>
                        </li>
                    </ol>
                    <button type="submit" class="btn btn-default">确认发布</button>
                </form>
        </div>
        <!--发布详情结束-->

    </div>
</div>
<script src="/static/admin/js/jquery-1.12.4.min.js"></script>
<script src="/static/admin/js/plug.js"></script>
<script src="/static/admin/lib/bootstrap/js/bootstrap.min.js"></script>
<script src="/static/admin/js/jquery.cookie.js"></script>
<script src="/static/admin/lib/bootstrap-tour/build/js/bootstrap-tour.min.js"></script>
<script src="/static/lib/editor/editormd.min.js"></script>
<script type="text/javascript">
    $(function() {
        editormd("diary-editormd", {
            width : "100%",
            height : 520,
            syncScrolling : "single",
            //你的lib目录的路径，和你引入js,css路径一样
            path    : "/static/lib/editor/lib/",
            //这个配置在simple.html中并没有，但是为了能够提交表单，使用这个配置可以让构造出来的HTML代码直接在第二个隐藏的textarea域中，方便post提交表单。
            saveHTMLToTextarea : true,
            imageUpload : true,
            emoji: true,
            imageFormats : ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
            imageUploadURL : "{:url('admin/User/uploadimg')}",
        });
        // var diary_img = document.getElementById('diary-img');
        // var show_img = document.getElementById('show-img');
        // var imgArr = [];
        // diary_img.onchange = function () {
        //     var files = diary_img.files;
        //     for (let i = 0; i < files.length; i++) {
        //         if (typeof FileReader == 'undefined') {
        //             alert('您的浏览器不支持图片上传，请升级您的浏览器');
        //             return false;
        //         }
        //         var reader = new FileReader();
        //         imgArr.push(files[i]);
        //         reader.readAsDataURL(files[i]);
        //         reader.onload = function (e) {
        //             var div = document.createElement('div');
        //             var img = document.createElement('img');
        //             var span = document.createElement('span');
        //             span.dataset.filename = imgArr[i].name;
        //             span.innerHTML = 'x';
        //             img.src = e.target.result;
        //             div.appendChild(img);
        //             div.appendChild(span);
        //             show_img.appendChild(div);
        //             show_img.style.display = 'block';
        //         };
        //         show_img.onclick = function (e) {
        //             var event = e || window.event;
        //             var target = event.target ||event.srcElement;
        //             if (target.nodeName.toLowerCase() == 'span') {
        //                 var input = document.createElement('input');
        //                 input.type = 'hidden';
        //                 input.name = 'hidden_imgs[]';
        //                 input.value = target.dataset.filename;
        //                 show_img.appendChild(input);
        //                 target.parentNode.remove();
        //             }
        //         }
        //     }
        // };
    });
</script>
</body>
</html>